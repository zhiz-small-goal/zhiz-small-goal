# C++ å¼•ç”¨ï¼ˆReferenceï¼‰è¯¦è§£

## ç›®å½•
1. [ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨ï¼Ÿ](#1-ä»€ä¹ˆæ˜¯å¼•ç”¨ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨)
2. [å¼•ç”¨çš„åŸºæœ¬è¯­æ³•](#2-å¼•ç”¨çš„åŸºæœ¬è¯­æ³•)
3. [å¼•ç”¨ vs æ™®é€šå˜é‡ï¼ˆå€¼ï¼‰](#3-å¼•ç”¨-vs-æ™®é€šå˜é‡å€¼)
4. [å‡½æ•°å‚æ•°ä¸­çš„å¼•ç”¨](#4-å‡½æ•°å‚æ•°ä¸­çš„å¼•ç”¨)
5. [å‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨](#5-å‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨)
6. [const å¼•ç”¨](#6-const-å¼•ç”¨)
7. [å®é™…ä½¿ç”¨åœºæ™¯](#7-å®é™…ä½¿ç”¨åœºæ™¯)
8. [å¸¸è§é”™è¯¯å’Œé™·é˜±](#8-å¸¸è§é”™è¯¯å’Œé™·é˜±)
9. [æ€»ç»“å¯¹æ¯”è¡¨](#9-æ€»ç»“å¯¹æ¯”è¡¨)

---

## 1. ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨ï¼Ÿ

### ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Ÿ
**å¼•ç”¨å°±æ˜¯ç»™ä¸€ä¸ªå·²å­˜åœ¨çš„å˜é‡èµ·ä¸€ä¸ªåˆ«åï¼ˆaliasï¼‰**ã€‚

å°±åƒäººå¯ä»¥æœ‰å¤šä¸ªåå­—ä¸€æ ·ï¼š
- æœ¬åï¼šå¼ ä¸‰
- å°åï¼šå°ä¸‰å­
- è‹±æ–‡åï¼šMike

è¿™ä¸‰ä¸ªåå­—éƒ½æŒ‡å‘åŒä¸€ä¸ªäººï¼Œå«å“ªä¸ªåå­—ï¼Œé‚£ä¸ªäººéƒ½ä¼šå›åº”ã€‚

åœ¨C++ä¸­ï¼Œå¼•ç”¨å°±æ˜¯è¿™æ ·çš„"åˆ«å"ï¼š
```cpp
int original = 10;    // åŸå§‹å˜é‡
int& nickname = original;  // nickname æ˜¯ original çš„åˆ«å
```

### ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨ï¼Ÿ

**é—®é¢˜åœºæ™¯ï¼š** å‡è®¾ä½ æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡ï¼ˆæ¯”å¦‚åŒ…å«100ä¸‡ä¸ªæ•°å­—çš„æ•°ç»„ï¼‰ï¼Œä½ æƒ³æŠŠå®ƒä¼ é€’ç»™å‡½æ•°å¤„ç†ã€‚

#### æ–¹æ³•1ï¼šä¼ é€’å€¼ï¼ˆä¸ä½¿ç”¨å¼•ç”¨ï¼‰
```cpp
void process(BigData data) {  // å¤åˆ¶æ•´ä¸ª data
    // å¤„ç† data
}

BigData myData;  // 100ä¸‡ä¸ªæ•°å­—
process(myData);  // å¤åˆ¶100ä¸‡ä¸ªæ•°å­—ï¼å¤ªæ…¢ï¼
```
**é—®é¢˜ï¼š** å¤åˆ¶100ä¸‡ä¸ªæ•°å­—ï¼Œæµªè´¹æ—¶é—´å’Œå†…å­˜ã€‚

#### æ–¹æ³•2ï¼šä¼ é€’å¼•ç”¨
```cpp
void process(BigData& data) {  // ä¸å¤åˆ¶ï¼Œç›´æ¥è®¿é—®åŸå§‹ data
    // å¤„ç† data
}

BigData myData;  // 100ä¸‡ä¸ªæ•°å­—
process(myData);  // ä¸å¤åˆ¶ï¼Œåªä¼ é€’"åˆ«å"ï¼å¿«ï¼
```
**å¥½å¤„ï¼š** ä¸å¤åˆ¶æ•°æ®ï¼Œç›´æ¥æ“ä½œåŸå§‹æ•°æ®ï¼Œå¿«é€Ÿä¸”çœå†…å­˜ã€‚

---

## 2. å¼•ç”¨çš„åŸºæœ¬è¯­æ³•

### 2.1 åŸºæœ¬è¯­æ³•æ‹†è§£

```cpp
int& refName = originalName;
```

**é€ä¸ªç¬¦å·æ‹†è§£ï¼š**

- `int` ï¼šç±»å‹ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•´æ•°
- `&` ï¼šå¼•ç”¨ç¬¦å·ï¼Œè¡¨ç¤º"è¿™æ˜¯ä¸€ä¸ªåˆ«å"ï¼ˆæ³¨æ„ï¼šè¿™é‡Œçš„ `&` ä¸æ˜¯"å–åœ°å€"çš„æ„æ€ï¼‰
- `refName` ï¼šå¼•ç”¨çš„åå­—ï¼ˆåˆ«åçš„åå­—ï¼‰
- `=` ï¼šèµ‹å€¼ç¬¦å·ï¼Œè¡¨ç¤º"æŠŠå³è¾¹çš„å˜é‡å…³è”åˆ°å·¦è¾¹çš„å¼•ç”¨"
- `originalName` ï¼šåŸå§‹å˜é‡çš„åå­—

**å®Œæ•´å«ä¹‰ï¼š**
> åˆ›å»ºä¸€ä¸ªåä¸º `refName` çš„å¼•ç”¨ï¼Œå®ƒæ˜¯ `originalName` çš„åˆ«åï¼Œç±»å‹æ˜¯ `int`

### 2.2 åˆ›å»ºå¼•ç”¨çš„ç¤ºä¾‹

```cpp
#include <iostream>

int main() {
    int x = 100;      // åŸå§‹å˜é‡
    int& ref = x;     // ref æ˜¯ x çš„åˆ«å
    
    std::cout << "x = " << x << std::endl;       // è¾“å‡º: x = 100
    std::cout << "ref = " << ref << std::endl;   // è¾“å‡º: ref = 100
    
    // ä¿®æ”¹ refï¼Œx ä¹Ÿä¼šå˜
    ref = 200;
    std::cout << "x = " << x << std::endl;       // è¾“å‡º: x = 200
    std::cout << "ref = " << ref << std::endl;   // è¾“å‡º: ref = 200
    
    // ä¿®æ”¹ xï¼Œref ä¹Ÿä¼šå˜
    x = 300;
    std::cout << "x = " << x << std::endl;       // è¾“å‡º: x = 300
    std::cout << "ref = " << ref << std::endl;   // è¾“å‡º: ref = 300
    
    return 0;
}
```

**å…³é”®ç†è§£ï¼š**
- `ref` å’Œ `x` æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œåªæ˜¯åå­—ä¸åŒ
- ä¿®æ”¹ `ref` å°±æ˜¯ä¿®æ”¹ `x`
- ä¿®æ”¹ `x` å°±æ˜¯ä¿®æ”¹ `ref`
- å®ƒä»¬å…±äº«åŒä¸€å—å†…å­˜

### 2.3 å¼•ç”¨çš„é‡è¦è§„åˆ™

#### è§„åˆ™1ï¼šå¼•ç”¨å¿…é¡»åˆå§‹åŒ–
```cpp
int x = 10;
int& ref = x;   // âœ… æ­£ç¡®ï¼šåˆ›å»ºå¼•ç”¨æ—¶ç«‹å³ç»‘å®šåˆ° x

int& ref2;      // âŒ é”™è¯¯ï¼šå¼•ç”¨å¿…é¡»åˆå§‹åŒ–ï¼
```

**ä¸ºä»€ä¹ˆï¼Ÿ**
> å¼•ç”¨æ˜¯åˆ«åï¼Œåˆ«åå¿…é¡»æœ‰"æœ¬å"ã€‚ä¸èƒ½æœ‰æ²¡æœ‰ä¸»äººçš„åˆ«åã€‚

#### è§„åˆ™2ï¼šå¼•ç”¨ä¸€æ—¦ç»‘å®šï¼Œä¸èƒ½æ”¹å˜
```cpp
int x = 10;
int y = 20;
int& ref = x;   // ref æ˜¯ x çš„åˆ«å

ref = y;        // è¿™ä¸æ˜¯è®© ref æ”¹ç»‘å®šåˆ° yï¼Œè€Œæ˜¯æŠŠ y çš„å€¼èµ‹ç»™ xï¼
// ç­‰ä»·äºï¼šx = y;

std::cout << x << std::endl;    // è¾“å‡º: 20
std::cout << ref << std::endl;  // è¾“å‡º: 20
std::cout << y << std::endl;    // è¾“å‡º: 20
```

**ç†è§£ï¼š**
- å¼•ç”¨ä¸€æ—¦åˆ›å»ºï¼Œå°±æ°¸è¿œæ˜¯é‚£ä¸ªå˜é‡çš„åˆ«å
- `ref = y` ä¸æ˜¯"æ”¹å˜åˆ«å"ï¼Œè€Œæ˜¯"é€šè¿‡åˆ«åä¿®æ”¹åŸå˜é‡çš„å€¼"

---

## 3. å¼•ç”¨ vs æ™®é€šå˜é‡ï¼ˆå€¼ï¼‰

### 3.1 æ™®é€šå˜é‡ï¼ˆå€¼ï¼‰

```cpp
int original = 10;
int copy = original;  // å¤åˆ¶ original çš„å€¼ç»™ copy

copy = 20;  // ä¿®æ”¹ copy
std::cout << "original = " << original << std::endl;  // è¾“å‡º: 10ï¼ˆæ²¡å˜ï¼‰
std::cout << "copy = " << copy << std::endl;          // è¾“å‡º: 20
```

**ç‰¹ç‚¹ï¼š**
- `copy` æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡
- å¤åˆ¶äº† `original` çš„å€¼
- ä¿®æ”¹ `copy` ä¸å½±å“ `original`
- å ç”¨ç‹¬ç«‹çš„å†…å­˜ç©ºé—´

### 3.2 å¼•ç”¨

```cpp
int original = 10;
int& alias = original;  // alias æ˜¯ original çš„åˆ«å

alias = 20;  // é€šè¿‡åˆ«åä¿®æ”¹
std::cout << "original = " << original << std::endl;  // è¾“å‡º: 20ï¼ˆå˜äº†ï¼ï¼‰
std::cout << "alias = " << alias << std::endl;        // è¾“å‡º: 20
```

**ç‰¹ç‚¹ï¼š**
- `alias` ä¸æ˜¯ç‹¬ç«‹çš„å˜é‡
- æ²¡æœ‰å¤åˆ¶å€¼
- ä¿®æ”¹ `alias` å°±æ˜¯ä¿®æ”¹ `original`
- ä¸å ç”¨é¢å¤–çš„å†…å­˜ï¼ˆå…±äº«åŒä¸€å—å†…å­˜ï¼‰

### 3.3 å¯¹æ¯”å›¾ç¤º

```
æ™®é€šå˜é‡ï¼ˆå€¼ï¼‰ï¼š
å†…å­˜: [10]  [10]
       â†‘     â†‘
      original  copy
      ï¼ˆç‹¬ç«‹çš„ä¸¤å—å†…å­˜ï¼‰

å¼•ç”¨ï¼š
å†…å­˜: [10]
       â†‘ â†‘
      original alias
      ï¼ˆåŒä¸€å—å†…å­˜ï¼Œä¸¤ä¸ªåå­—ï¼‰
```

---

## 4. å‡½æ•°å‚æ•°ä¸­çš„å¼•ç”¨

### 4.1 ä¼ å€¼ï¼ˆPass by Valueï¼‰

#### è¯­æ³•æ‹†è§£
```cpp
void func(int x) {
    // ...
}
```

- `void` ï¼šè¿”å›ç±»å‹ï¼Œè¡¨ç¤º"å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼"
- `func` ï¼šå‡½æ•°å
- `(int x)` ï¼šå‚æ•°åˆ—è¡¨
  - `int` ï¼šå‚æ•°ç±»å‹
  - `x` ï¼šå‚æ•°åï¼ˆè¿™æ˜¯ä¸€ä¸ª**å‰¯æœ¬**ï¼‰

#### å®Œæ•´ç¤ºä¾‹
```cpp
#include <iostream>

void modifyValue(int x) {
    x = 100;  // ä¿®æ”¹çš„æ˜¯å‰¯æœ¬
    std::cout << "å‡½æ•°å†… x = " << x << std::endl;
}

int main() {
    int num = 10;
    std::cout << "è°ƒç”¨å‰ num = " << num << std::endl;  // è¾“å‡º: 10
    
    modifyValue(num);  // ä¼ é€’ num çš„å‰¯æœ¬
    // è¾“å‡º: å‡½æ•°å†… x = 100
    
    std::cout << "è°ƒç”¨å num = " << num << std::endl;  // è¾“å‡º: 10ï¼ˆæ²¡å˜ï¼ï¼‰
    
    return 0;
}
```

**æµç¨‹åˆ†æï¼š**
1. `modifyValue(num)` è¢«è°ƒç”¨
2. å¤åˆ¶ `num` çš„å€¼ï¼ˆ10ï¼‰åˆ°å‡½æ•°å‚æ•° `x`
3. å‡½æ•°å†…éƒ¨ä¿®æ”¹ `x` ä¸º 100
4. å‡½æ•°ç»“æŸï¼Œ`x` è¢«é”€æ¯
5. åŸå§‹çš„ `num` æ²¡æœ‰è¢«å½±å“

**ç‰¹ç‚¹ï¼š**
- âœ… å®‰å…¨ï¼šä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®
- âŒ æ…¢ï¼šéœ€è¦å¤åˆ¶æ•°æ®ï¼ˆå¦‚æœæ•°æ®å¾ˆå¤§ï¼Œä¼šå¾ˆæ…¢ï¼‰
- âŒ è´¹å†…å­˜ï¼šéœ€è¦é¢å¤–çš„å†…å­˜å­˜å‚¨å‰¯æœ¬

### 4.2 ä¼ å¼•ç”¨ï¼ˆPass by Referenceï¼‰

#### è¯­æ³•æ‹†è§£
```cpp
void func(int& x) {
    // ...
}
```

- `void` ï¼šè¿”å›ç±»å‹
- `func` ï¼šå‡½æ•°å
- `(int& x)` ï¼šå‚æ•°åˆ—è¡¨
  - `int` ï¼šå‚æ•°ç±»å‹
  - `&` ï¼šå¼•ç”¨ç¬¦å·ï¼Œè¡¨ç¤º"è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å‚æ•°"
  - `x` ï¼šå‚æ•°åï¼ˆè¿™æ˜¯**åŸå§‹å˜é‡çš„åˆ«å**ï¼‰

#### å®Œæ•´ç¤ºä¾‹
```cpp
#include <iostream>

void modifyReference(int& x) {
    x = 100;  // ä¿®æ”¹çš„æ˜¯åŸå§‹å˜é‡
    std::cout << "å‡½æ•°å†… x = " << x << std::endl;
}

int main() {
    int num = 10;
    std::cout << "è°ƒç”¨å‰ num = " << num << std::endl;  // è¾“å‡º: 10
    
    modifyReference(num);  // ä¼ é€’ num çš„å¼•ç”¨ï¼ˆåˆ«åï¼‰
    // è¾“å‡º: å‡½æ•°å†… x = 100
    
    std::cout << "è°ƒç”¨å num = " << num << std::endl;  // è¾“å‡º: 100ï¼ˆå˜äº†ï¼ï¼‰
    
    return 0;
}
```

**æµç¨‹åˆ†æï¼š**
1. `modifyReference(num)` è¢«è°ƒç”¨
2. ä¸å¤åˆ¶ `num`ï¼ŒåªæŠŠ `num` çš„"åˆ«å"ä¼ ç»™å‡½æ•°å‚æ•° `x`
3. å‡½æ•°å†…éƒ¨ä¿®æ”¹ `x`ï¼Œå®é™…ä¸Šå°±æ˜¯ä¿®æ”¹ `num`
4. å‡½æ•°ç»“æŸï¼Œ`num` å·²ç»è¢«ä¿®æ”¹ä¸º 100

**ç‰¹ç‚¹ï¼š**
- âœ… å¿«ï¼šä¸å¤åˆ¶æ•°æ®
- âœ… çœå†…å­˜ï¼šä¸éœ€è¦é¢å¤–å†…å­˜
- âš ï¸ å±é™©ï¼šä¼šä¿®æ”¹åŸå§‹æ•°æ®ï¼ˆéœ€è¦å°å¿ƒä½¿ç”¨ï¼‰

### 4.3 ä¼  const å¼•ç”¨ï¼ˆPass by Const Referenceï¼‰

#### è¯­æ³•æ‹†è§£
```cpp
void func(const int& x) {
    // ...
}
```

- `void` ï¼šè¿”å›ç±»å‹
- `func` ï¼šå‡½æ•°å
- `(const int& x)` ï¼šå‚æ•°åˆ—è¡¨
  - `const` ï¼šå¸¸é‡ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤º"ä¸å¯ä¿®æ”¹"
  - `int` ï¼šå‚æ•°ç±»å‹
  - `&` ï¼šå¼•ç”¨ç¬¦å·
  - `x` ï¼šå‚æ•°åï¼ˆè¿™æ˜¯**åªè¯»çš„å¼•ç”¨**ï¼‰

#### å®Œæ•´ç¤ºä¾‹
```cpp
#include <iostream>

void readOnly(const int& x) {
    std::cout << "è¯»å– x = " << x << std::endl;
    // x = 100;  // âŒ é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹ const å¼•ç”¨
}

int main() {
    int num = 10;
    readOnly(num);  // ä¼ é€’ num çš„åªè¯»å¼•ç”¨
    std::cout << "num = " << num << std::endl;  // è¾“å‡º: 10ï¼ˆæ²¡å˜ï¼‰
    
    return 0;
}
```

**ç‰¹ç‚¹ï¼š**
- âœ… å¿«ï¼šä¸å¤åˆ¶æ•°æ®
- âœ… çœå†…å­˜ï¼šä¸éœ€è¦é¢å¤–å†…å­˜
- âœ… å®‰å…¨ï¼šä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®ï¼ˆç¼–è¯‘å™¨ä¿è¯ï¼‰

**æœ€ä½³å®è·µï¼š**
> å¦‚æœå‡½æ•°ä¸éœ€è¦ä¿®æ”¹å‚æ•°ï¼Œå°±ç”¨ `const å¼•ç”¨`ï¼Œæ—¢å¿«åˆå®‰å…¨ï¼

### 4.4 å¯¹æ¯”è¡¨

| ä¼ é€’æ–¹å¼ | è¯­æ³• | æ˜¯å¦å¤åˆ¶ | èƒ½å¦ä¿®æ”¹åŸå€¼ | é€Ÿåº¦ | å†…å­˜ | é€‚ç”¨åœºæ™¯ |
|---------|------|---------|-------------|------|------|---------|
| ä¼ å€¼ | `func(int x)` | âœ… æ˜¯ | âŒ å¦ | æ…¢ | å¤š | å°æ•°æ®ï¼Œä¸éœ€è¦ä¿®æ”¹ |
| ä¼ å¼•ç”¨ | `func(int& x)` | âŒ å¦ | âœ… æ˜¯ | å¿« | å°‘ | å¤§æ•°æ®ï¼Œéœ€è¦ä¿®æ”¹ |
| ä¼ constå¼•ç”¨ | `func(const int& x)` | âŒ å¦ | âŒ å¦ | å¿« | å°‘ | å¤§æ•°æ®ï¼Œä¸éœ€è¦ä¿®æ”¹ |

---

## 5. å‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨

### 5.1 è¿”å›å€¼ï¼ˆReturn by Valueï¼‰

#### è¯­æ³•æ‹†è§£
```cpp
int func() {
    int x = 10;
    return x;
}
```

- `int` ï¼šè¿”å›ç±»å‹ï¼Œè¡¨ç¤º"å‡½æ•°è¿”å›ä¸€ä¸ª int å€¼"
- `func` ï¼šå‡½æ•°å
- `()` ï¼šå‚æ•°åˆ—è¡¨ï¼ˆè¿™é‡Œæ˜¯ç©ºçš„ï¼‰
- `return x` ï¼šè¿”å› `x` çš„å‰¯æœ¬

#### å®Œæ•´ç¤ºä¾‹
```cpp
#include <iostream>

int getValue() {
    int x = 10;
    return x;  // è¿”å› x çš„å‰¯æœ¬
}  // x åœ¨è¿™é‡Œè¢«é”€æ¯

int main() {
    int result = getValue();
    std::cout << "result = " << result << std::endl;  // è¾“å‡º: 10
    
    return 0;
}
```

**æµç¨‹åˆ†æï¼š**
1. `getValue()` è¢«è°ƒç”¨
2. åˆ›å»ºå±€éƒ¨å˜é‡ `x = 10`
3. `return x` å¤åˆ¶ `x` çš„å€¼
4. å‡½æ•°ç»“æŸï¼Œ`x` è¢«é”€æ¯
5. å‰¯æœ¬è¢«èµ‹å€¼ç»™ `result`

**ç‰¹ç‚¹ï¼š**
- âœ… å®‰å…¨ï¼šè¿”å›çš„æ˜¯å‰¯æœ¬ï¼ŒåŸå§‹å˜é‡é”€æ¯ä¹Ÿæ²¡å…³ç³»
- âŒ æ…¢ï¼šéœ€è¦å¤åˆ¶æ•°æ®

### 5.2 è¿”å›å¼•ç”¨ï¼ˆReturn by Referenceï¼‰

#### è¯­æ³•æ‹†è§£
```cpp
int& func() {
    // ...
    return x;
}
```

- `int&` ï¼šè¿”å›ç±»å‹ï¼Œè¡¨ç¤º"å‡½æ•°è¿”å›ä¸€ä¸ª int å¼•ç”¨"
  - `int` ï¼šç±»å‹
  - `&` ï¼šå¼•ç”¨ç¬¦å·ï¼Œè¡¨ç¤º"è¿”å›çš„æ˜¯å¼•ç”¨ï¼ˆåˆ«åï¼‰"
- `func` ï¼šå‡½æ•°å
- `return x` ï¼šè¿”å› `x` çš„å¼•ç”¨ï¼ˆåˆ«åï¼‰

#### å®‰å…¨çš„ç¤ºä¾‹ï¼šè¿”å›å¤–éƒ¨å˜é‡çš„å¼•ç”¨
```cpp
#include <iostream>

int globalVar = 100;

int& getGlobal() {
    return globalVar;  // âœ… å®‰å…¨ï¼šè¿”å›å…¨å±€å˜é‡çš„å¼•ç”¨
}

int main() {
    int& ref = getGlobal();
    std::cout << "ref = " << ref << std::endl;  // è¾“å‡º: 100
    
    ref = 200;  // ä¿®æ”¹å¼•ç”¨ï¼Œå®é™…ä¿®æ”¹çš„æ˜¯ globalVar
    std::cout << "globalVar = " << globalVar << std::endl;  // è¾“å‡º: 200
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆå®‰å…¨ï¼Ÿ**
> `globalVar` æ˜¯å…¨å±€å˜é‡ï¼Œç¨‹åºç»“æŸå‰ä¸€ç›´å­˜åœ¨ï¼Œæ‰€ä»¥è¿”å›å®ƒçš„å¼•ç”¨æ˜¯å®‰å…¨çš„ã€‚

#### å±é™©çš„ç¤ºä¾‹ï¼šè¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ âš ï¸
```cpp
#include <iostream>

int& getDangerous() {
    int x = 10;
    return x;  // âŒ å±é™©ï¼šè¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ï¼
}  // x åœ¨è¿™é‡Œè¢«é”€æ¯ï¼

int main() {
    int& ref = getDangerous();
    // ref ç°åœ¨æ˜¯"æ‚¬ç©ºå¼•ç”¨"ï¼ˆdangling referenceï¼‰
    // å®ƒæŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾äº†
    
    std::cout << ref << std::endl;  // æœªå®šä¹‰è¡Œä¸ºï¼å¯èƒ½å´©æºƒï¼
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆå±é™©ï¼Ÿ**
> `x` æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ç»“æŸåå°±è¢«é”€æ¯äº†ã€‚è¿”å›å®ƒçš„å¼•ç”¨å°±åƒ"ç»™ä¸€ä¸ªå·²ç»ä¸å­˜åœ¨çš„äººèµ·åˆ«å"ã€‚

**æµç¨‹åˆ†æï¼š**
1. `getDangerous()` è¢«è°ƒç”¨
2. åˆ›å»ºå±€éƒ¨å˜é‡ `x = 10`
3. `return x` è¿”å› `x` çš„å¼•ç”¨
4. å‡½æ•°ç»“æŸï¼Œ`x` è¢«é”€æ¯ï¼ˆå†…å­˜è¢«é‡Šæ”¾ï¼‰
5. `ref` ç°åœ¨æŒ‡å‘ä¸€å—è¢«é‡Šæ”¾çš„å†…å­˜ï¼ˆæ‚¬ç©ºå¼•ç”¨ï¼‰
6. è®¿é—® `ref` æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼ˆå¯èƒ½è¯»åˆ°åƒåœ¾å€¼ï¼Œå¯èƒ½å´©æºƒï¼‰

#### å¯¹æ¯”å›¾ç¤º

```
å®‰å…¨çš„è¿”å›å¼•ç”¨ï¼š
å…¨å±€å˜é‡åŒº: [100]
             â†‘
          globalVar (ä¸€ç›´å­˜åœ¨)
             â†‘
       getGlobal() è¿”å›çš„å¼•ç”¨

å±é™©çš„è¿”å›å¼•ç”¨ï¼š
æ ˆå†…å­˜: [10]  â†’  [å·²é‡Šæ”¾]
         â†‘           â†‘
        x           refï¼ˆæ‚¬ç©ºå¼•ç”¨ï¼‰
    ï¼ˆå‡½æ•°å†…ï¼‰    ï¼ˆå‡½æ•°å¤–ï¼‰
```

### 5.3 è¿”å›å¼•ç”¨çš„æ­£ç¡®ç”¨æ³•

#### åœºæ™¯1ï¼šè¿”å›å…¨å±€å˜é‡æˆ–é™æ€å˜é‡çš„å¼•ç”¨
```cpp
int& getStaticVar() {
    static int x = 10;  // é™æ€å˜é‡ï¼Œç¨‹åºç»“æŸå‰ä¸€ç›´å­˜åœ¨
    return x;
}
```

#### åœºæ™¯2ï¼šè¿”å›å‚æ•°çš„å¼•ç”¨ï¼ˆé“¾å¼è°ƒç”¨ï¼‰
```cpp
#include <iostream>
#include <string>

std::string& append(std::string& str, const std::string& suffix) {
    str += suffix;
    return str;  // è¿”å›å‚æ•°æœ¬èº«çš„å¼•ç”¨
}

int main() {
    std::string text = "Hello";
    
    // é“¾å¼è°ƒç”¨
    append(append(text, " World"), "!");
    
    std::cout << text << std::endl;  // è¾“å‡º: Hello World!
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆå®‰å…¨ï¼Ÿ**
> è¿”å›çš„æ˜¯å‚æ•° `str` çš„å¼•ç”¨ï¼Œè€Œ `str` æ˜¯ `main` å‡½æ•°ä¸­ `text` çš„å¼•ç”¨ï¼Œ`text` åœ¨ `main` å‡½æ•°ç»“æŸå‰ä¸€ç›´å­˜åœ¨ã€‚

#### åœºæ™¯3ï¼šè¿”å›ç±»æˆå‘˜å˜é‡çš„å¼•ç”¨
```cpp
#include <iostream>
#include <string>

class Person {
private:
    std::string name;
    
public:
    Person(const std::string& n) : name(n) {}
    
    std::string& getName() {
        return name;  // è¿”å›æˆå‘˜å˜é‡çš„å¼•ç”¨
    }
    
    const std::string& getName() const {
        return name;  // const ç‰ˆæœ¬ï¼Œè¿”å› const å¼•ç”¨
    }
};

int main() {
    Person p("Alice");
    
    // è·å–å¹¶ä¿®æ”¹
    p.getName() = "Bob";
    std::cout << p.getName() << std::endl;  // è¾“å‡º: Bob
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆå®‰å…¨ï¼Ÿ**
> æˆå‘˜å˜é‡ `name` çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡ `p` ä¸€æ ·é•¿ï¼Œåªè¦ `p` å­˜åœ¨ï¼Œ`name` å°±å­˜åœ¨ã€‚

---

## 6. const å¼•ç”¨

### 6.1 ä»€ä¹ˆæ˜¯ const å¼•ç”¨ï¼Ÿ

**å®šä¹‰ï¼š** const å¼•ç”¨æ˜¯ä¸€ä¸ªåªè¯»çš„å¼•ç”¨ï¼Œä¸èƒ½é€šè¿‡å®ƒä¿®æ”¹åŸå§‹å˜é‡ã€‚

#### è¯­æ³•æ‹†è§£
```cpp
const int& ref = x;
```

- `const` ï¼šå¸¸é‡ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤º"ä¸å¯ä¿®æ”¹"
- `int` ï¼šç±»å‹
- `&` ï¼šå¼•ç”¨ç¬¦å·
- `ref` ï¼šå¼•ç”¨çš„åå­—
- `=` ï¼šç»‘å®šç¬¦å·
- `x` ï¼šåŸå§‹å˜é‡

**å®Œæ•´å«ä¹‰ï¼š**
> åˆ›å»ºä¸€ä¸ªåä¸º `ref` çš„å¼•ç”¨ï¼Œå®ƒæ˜¯ `x` çš„åˆ«åï¼Œç±»å‹æ˜¯ `int`ï¼Œä½†æ˜¯**åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹**ã€‚

### 6.2 åŸºæœ¬ç¤ºä¾‹

```cpp
#include <iostream>

int main() {
    int x = 10;
    const int& ref = x;  // ref æ˜¯ x çš„åªè¯»å¼•ç”¨
    
    std::cout << "x = " << x << std::endl;      // è¾“å‡º: 10
    std::cout << "ref = " << ref << std::endl;  // è¾“å‡º: 10
    
    // ref = 20;  // âŒ é”™è¯¯ï¼šä¸èƒ½é€šè¿‡ const å¼•ç”¨ä¿®æ”¹
    
    x = 20;  // âœ… å¯ä»¥ç›´æ¥ä¿®æ”¹ x
    std::cout << "x = " << x << std::endl;      // è¾“å‡º: 20
    std::cout << "ref = " << ref << std::endl;  // è¾“å‡º: 20ï¼ˆref çœ‹åˆ°çš„æ˜¯æœ€æ–°çš„ xï¼‰
    
    return 0;
}
```

**å…³é”®ç†è§£ï¼š**
- `const int& ref = x` è¡¨ç¤º"ä¸èƒ½é€šè¿‡ `ref` ä¿®æ”¹ `x`"
- ä½†å¯ä»¥ç›´æ¥ä¿®æ”¹ `x`
- `ref` å§‹ç»ˆåæ˜  `x` çš„æœ€æ–°å€¼

### 6.3 const å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å€¼

#### æ™®é€šå¼•ç”¨ä¸èƒ½ç»‘å®šåˆ°ä¸´æ—¶å€¼
```cpp
int& ref = 10;  // âŒ é”™è¯¯ï¼šä¸èƒ½ç»‘å®šåˆ°ä¸´æ—¶å€¼
```

#### const å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å€¼
```cpp
const int& ref = 10;  // âœ… æ­£ç¡®ï¼šconst å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å€¼
std::cout << ref << std::endl;  // è¾“å‡º: 10
```

**ä¸ºä»€ä¹ˆï¼Ÿ**
> å› ä¸º `const` ä¿è¯äº†ä¸ä¼šä¿®æ”¹è¿™ä¸ªä¸´æ—¶å€¼ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å…è®¸è¿™æ ·åšã€‚ç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡å­˜å‚¨ `10`ï¼Œç„¶åè®© `ref` ç»‘å®šåˆ°è¿™ä¸ªä¸´æ—¶å˜é‡ã€‚

#### å®é™…åº”ç”¨ï¼šæ¥å—å­—é¢é‡
```cpp
#include <iostream>
#include <string>

void print(const std::string& str) {
    std::cout << str << std::endl;
}

int main() {
    print("Hello");  // âœ… æ­£ç¡®ï¼š"Hello" æ˜¯ä¸´æ—¶çš„ const char*ï¼Œ
                     // è¢«è½¬æ¢ä¸ºä¸´æ—¶çš„ std::stringï¼Œ
                     // const å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°å®ƒ
    
    std::string s = "World";
    print(s);  // âœ… æ­£ç¡®ï¼šä¹Ÿå¯ä»¥æ¥å—æ™®é€šå˜é‡
    
    return 0;
}
```

å¦‚æœä¸ç”¨ const å¼•ç”¨ï¼š
```cpp
void print(std::string& str) {  // æ³¨æ„ï¼šæ²¡æœ‰ const
    std::cout << str << std::endl;
}

int main() {
    print("Hello");  // âŒ é”™è¯¯ï¼šä¸èƒ½ç»‘å®šåˆ°ä¸´æ—¶å€¼
    
    std::string s = "World";
    print(s);  // âœ… æ­£ç¡®ï¼šå¯ä»¥æ¥å—æ™®é€šå˜é‡
    
    return 0;
}
```

### 6.4 const å¼•ç”¨çš„æœ€ä½³å®è·µ

**è§„åˆ™ï¼š** å¦‚æœå‡½æ•°ä¸éœ€è¦ä¿®æ”¹å‚æ•°ï¼Œå°±ç”¨ `const å¼•ç”¨`ã€‚

```cpp
#include <iostream>
#include <string>

// âŒ ä¸å¥½ï¼šä¼ å€¼ï¼Œä¼šå¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²
void printBad(std::string str) {
    std::cout << str << std::endl;
}

// âœ… å¥½ï¼šä¼  const å¼•ç”¨ï¼Œä¸å¤åˆ¶ï¼Œä¸ä¿®æ”¹
void printGood(const std::string& str) {
    std::cout << str << std::endl;
}

int main() {
    std::string longText = "è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿å¾ˆé•¿çš„å­—ç¬¦ä¸²...";
    
    printBad(longText);   // å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œæ…¢ï¼
    printGood(longText);  // ä¸å¤åˆ¶ï¼Œå¿«ï¼
    
    return 0;
}
```

---

## 7. å®é™…ä½¿ç”¨åœºæ™¯

### 7.1 åœºæ™¯1ï¼šé¿å…å¤§å¯¹è±¡çš„å¤åˆ¶

#### é—®é¢˜åœºæ™¯
```cpp
#include <iostream>
#include <vector>

// ä¸å¥½çš„å†™æ³•ï¼šä¼ å€¼
void processBad(std::vector<int> data) {  // å¤åˆ¶æ•´ä¸ª vectorï¼
    for (int num : data) {
        std::cout << num << " ";
    }
    std::cout << std::endl;
}

int main() {
    std::vector<int> bigData(1000000, 1);  // 100ä¸‡ä¸ªå…ƒç´ 
    processBad(bigData);  // å¤åˆ¶100ä¸‡ä¸ªå…ƒç´ ï¼Œæ…¢ï¼
    return 0;
}
```

#### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ const å¼•ç”¨
```cpp
#include <iostream>
#include <vector>

// å¥½çš„å†™æ³•ï¼šä¼  const å¼•ç”¨
void processGood(const std::vector<int>& data) {  // ä¸å¤åˆ¶ï¼
    for (int num : data) {
        std::cout << num << " ";
    }
    std::cout << std::endl;
}

int main() {
    std::vector<int> bigData(1000000, 1);  // 100ä¸‡ä¸ªå…ƒç´ 
    processGood(bigData);  // ä¸å¤åˆ¶ï¼Œå¿«ï¼
    return 0;
}
```

**å¯¹æ¯”ï¼š**
- `processBad`ï¼šå¤åˆ¶100ä¸‡ä¸ªæ•´æ•°ï¼Œè€—æ—¶ä¸”å å†…å­˜
- `processGood`ï¼šä¸å¤åˆ¶ï¼Œåªä¼ é€’"åˆ«å"ï¼Œå¿«é€Ÿä¸”çœå†…å­˜

### 7.2 åœºæ™¯2ï¼šå‡½æ•°éœ€è¦ä¿®æ”¹å‚æ•°

#### é—®é¢˜åœºæ™¯ï¼šäº¤æ¢ä¸¤ä¸ªå˜é‡
```cpp
#include <iostream>

// ä¸å¥½çš„å†™æ³•ï¼šä¼ å€¼
void swapBad(int a, int b) {
    int temp = a;
    a = b;
    b = temp;
    // a å’Œ b åªæ˜¯å‰¯æœ¬ï¼ŒåŸå§‹å˜é‡ä¸ä¼šè¢«ä¿®æ”¹
}

int main() {
    int x = 10, y = 20;
    swapBad(x, y);
    std::cout << "x = " << x << ", y = " << y << std::endl;
    // è¾“å‡º: x = 10, y = 20ï¼ˆæ²¡æœ‰äº¤æ¢ï¼ï¼‰
    return 0;
}
```

#### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å¼•ç”¨
```cpp
#include <iostream>

// å¥½çš„å†™æ³•ï¼šä¼ å¼•ç”¨
void swapGood(int& a, int& b) {
    int temp = a;
    a = b;
    b = temp;
    // a å’Œ b æ˜¯åŸå§‹å˜é‡çš„åˆ«åï¼Œä¼šä¿®æ”¹åŸå§‹å˜é‡
}

int main() {
    int x = 10, y = 20;
    swapGood(x, y);
    std::cout << "x = " << x << ", y = " << y << std::endl;
    // è¾“å‡º: x = 20, y = 10ï¼ˆæˆåŠŸäº¤æ¢ï¼ï¼‰
    return 0;
}
```

### 7.3 åœºæ™¯3ï¼šé“¾å¼è°ƒç”¨

#### é—®é¢˜ï¼šå¦‚ä½•å®ç° `obj.func1().func2().func3()`ï¼Ÿ

```cpp
#include <iostream>
#include <string>

class StringBuilder {
private:
    std::string data;
    
public:
    // è¿”å›å¼•ç”¨ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
    StringBuilder& append(const std::string& str) {
        data += str;
        return *this;  // è¿”å›è‡ªå·±çš„å¼•ç”¨
    }
    
    StringBuilder& appendLine(const std::string& str) {
        data += str + "\n";
        return *this;  // è¿”å›è‡ªå·±çš„å¼•ç”¨
    }
    
    std::string build() const {
        return data;
    }
};

int main() {
    StringBuilder builder;
    
    // é“¾å¼è°ƒç”¨
    std::string result = builder
        .append("Hello")
        .append(" ")
        .append("World")
        .appendLine("!")
        .append("Nice to meet you.")
        .build();
    
    std::cout << result << std::endl;
    // è¾“å‡º:
    // Hello World!
    // Nice to meet you.
    
    return 0;
}
```

**å…³é”®ï¼š**
- `append` å’Œ `appendLine` è¿”å› `StringBuilder&`ï¼ˆå¼•ç”¨ï¼‰
- `return *this` è¿”å›å¯¹è±¡è‡ªå·±çš„å¼•ç”¨
- è¿™æ ·å°±å¯ä»¥è¿ç»­è°ƒç”¨ï¼š`builder.append(...).append(...).append(...)`

#### è¯­æ³•æ‹†è§£ï¼š`return *this`

```cpp
StringBuilder& append(const std::string& str) {
    data += str;
    return *this;
}
```

- `StringBuilder&` ï¼šè¿”å›ç±»å‹ï¼Œè¡¨ç¤º"è¿”å› StringBuilder çš„å¼•ç”¨"
- `append` ï¼šå‡½æ•°å
- `const std::string& str` ï¼šå‚æ•°ï¼ˆconst å¼•ç”¨ï¼‰
- `return *this` ï¼šè¿”å›è¯­å¥
  - `this` ï¼šæŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡
  - `*this` ï¼šè§£å¼•ç”¨ï¼Œè·å–å½“å‰å¯¹è±¡æœ¬èº«
  - `return *this` ï¼šè¿”å›å½“å‰å¯¹è±¡çš„å¼•ç”¨

**å®Œæ•´å«ä¹‰ï¼š**
> è¿™ä¸ªå‡½æ•°è¿”å›å½“å‰å¯¹è±¡è‡ªå·±çš„å¼•ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥ç»§ç»­è°ƒç”¨å…¶ä»–å‡½æ•°ã€‚

### 7.4 åœºæ™¯4ï¼šè¯»å–å’Œä¿®æ”¹å®¹å™¨å…ƒç´ 

```cpp
#include <iostream>
#include <vector>

int main() {
    std::vector<int> numbers = {1, 2, 3, 4, 5};
    
    // ä½¿ç”¨å¼•ç”¨ä¿®æ”¹å®¹å™¨å…ƒç´ 
    for (int& num : numbers) {  // æ³¨æ„ï¼šint& å¼•ç”¨
        num *= 2;  // ä¿®æ”¹åŸå§‹å…ƒç´ 
    }
    
    // ä½¿ç”¨ const å¼•ç”¨è¯»å–å®¹å™¨å…ƒç´ 
    for (const int& num : numbers) {  // æ³¨æ„ï¼šconst int& å¼•ç”¨
        std::cout << num << " ";  // åªè¯»å–ï¼Œä¸ä¿®æ”¹
    }
    std::cout << std::endl;
    // è¾“å‡º: 2 4 6 8 10
    
    return 0;
}
```

**å¯¹æ¯”ä¸‰ç§å†™æ³•ï¼š**

```cpp
std::vector<std::string> names = {"Alice", "Bob", "Charlie"};

// å†™æ³•1ï¼šä¼ å€¼ï¼ˆå¤åˆ¶ï¼‰
for (std::string name : names) {
    // name æ˜¯å‰¯æœ¬ï¼Œä¿®æ”¹ name ä¸å½±å“åŸå§‹å…ƒç´ 
    // æ¯æ¬¡å¾ªç¯éƒ½å¤åˆ¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ…¢ï¼
}

// å†™æ³•2ï¼šä¼ å¼•ç”¨ï¼ˆå¯ä¿®æ”¹ï¼‰
for (std::string& name : names) {
    // name æ˜¯å¼•ç”¨ï¼Œä¿®æ”¹ name ä¼šå½±å“åŸå§‹å…ƒç´ 
    // ä¸å¤åˆ¶ï¼Œå¿«ï¼
}

// å†™æ³•3ï¼šä¼  const å¼•ç”¨ï¼ˆåªè¯»ï¼‰
for (const std::string& name : names) {
    // name æ˜¯ const å¼•ç”¨ï¼Œåªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹
    // ä¸å¤åˆ¶ï¼Œå¿«ï¼
    // æœ€å®‰å…¨ï¼
}
```

**æœ€ä½³å®è·µï¼š**
- éœ€è¦ä¿®æ”¹å…ƒç´ ï¼šç”¨ `ç±»å‹& å˜é‡å`
- åªéœ€è¦è¯»å–å…ƒç´ ï¼šç”¨ `const ç±»å‹& å˜é‡å`
- åŸºæœ¬ç±»å‹ï¼ˆint, doubleç­‰ï¼‰ï¼šç”¨ `ç±»å‹ å˜é‡å`ï¼ˆä¼ å€¼åè€Œæ›´å¿«ï¼‰

### 7.5 åœºæ™¯5ï¼šæ“ä½œç¬¦é‡è½½ä¸­çš„å¼•ç”¨

```cpp
#include <iostream>

class Counter {
private:
    int count;
    
public:
    Counter() : count(0) {}
    
    // å‰ç½® ++ï¼šè¿”å›å¼•ç”¨
    Counter& operator++() {
        ++count;
        return *this;  // è¿”å›è‡ªå·±çš„å¼•ç”¨
    }
    
    // åç½® ++ï¼šè¿”å›å€¼ï¼ˆå‰¯æœ¬ï¼‰
    Counter operator++(int) {
        Counter temp = *this;  // ä¿å­˜å½“å‰çŠ¶æ€
        ++count;
        return temp;  // è¿”å›æ—§å€¼çš„å‰¯æœ¬
    }
    
    int getCount() const {
        return count;
    }
};

int main() {
    Counter c;
    
    // å‰ç½® ++ï¼Œå¯ä»¥é“¾å¼è°ƒç”¨
    ++++c;  // ç­‰ä»·äº ++(++c)
    std::cout << "count = " << c.getCount() << std::endl;  // è¾“å‡º: 2
    
    // åç½® ++ï¼Œä¸èƒ½é“¾å¼è°ƒç”¨
    // c++++; // âŒ é”™è¯¯ï¼šä¸èƒ½å¯¹ä¸´æ—¶å¯¹è±¡ä½¿ç”¨ ++
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆå‰ç½®++è¿”å›å¼•ç”¨ï¼Œåç½®++è¿”å›å€¼ï¼Ÿ**
- å‰ç½® `++i`ï¼šå…ˆåŠ 1ï¼Œå†è¿”å›ï¼Œè¿”å›çš„æ˜¯åŠ 1åçš„è‡ªå·± â†’ è¿”å›å¼•ç”¨
- åç½® `i++`ï¼šå…ˆè¿”å›ï¼Œå†åŠ 1ï¼Œè¿”å›çš„æ˜¯åŠ 1å‰çš„å‰¯æœ¬ â†’ è¿”å›å€¼

---

## 8. å¸¸è§é”™è¯¯å’Œé™·é˜±

### 8.1 é”™è¯¯1ï¼šè¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ âš ï¸

```cpp
int& getDangerous() {
    int x = 10;
    return x;  // âŒ é”™è¯¯ï¼šx æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ç»“æŸåè¢«é”€æ¯
}

int main() {
    int& ref = getDangerous();
    std::cout << ref << std::endl;  // æœªå®šä¹‰è¡Œä¸ºï¼
    return 0;
}
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
> `x` æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ç»“æŸåå°±è¢«é”€æ¯äº†ã€‚è¿”å›å®ƒçš„å¼•ç”¨å°±åƒ"ç»™æ­»äººèµ·åˆ«å"ã€‚

**å¦‚ä½•é¿å…ï¼Ÿ**
- ä¸è¦è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨
- åªè¿”å›å…¨å±€å˜é‡ã€é™æ€å˜é‡ã€å‚æ•°ã€æˆå‘˜å˜é‡çš„å¼•ç”¨

### 8.2 é”™è¯¯2ï¼šæ‚¬ç©ºå¼•ç”¨ï¼ˆDangling Referenceï¼‰

```cpp
#include <iostream>

int main() {
    int* ptr = new int(10);
    int& ref = *ptr;  // ref æ˜¯ *ptr çš„å¼•ç”¨
    
    delete ptr;  // é‡Šæ”¾å†…å­˜
    
    std::cout << ref << std::endl;  // âŒ é”™è¯¯ï¼šref ç°åœ¨æ˜¯æ‚¬ç©ºå¼•ç”¨
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
> `ptr` æŒ‡å‘çš„å†…å­˜è¢«é‡Šæ”¾åï¼Œ`ref` ä»ç„¶å¼•ç”¨é‚£å—å†…å­˜ï¼Œä½†é‚£å—å†…å­˜å·²ç»æ— æ•ˆäº†ã€‚

**å¦‚ä½•é¿å…ï¼Ÿ**
- å°å¿ƒç®¡ç†å†…å­˜
- ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆ`std::unique_ptr`, `std::shared_ptr`ï¼‰

### 8.3 é”™è¯¯3ï¼šå¼•ç”¨æ²¡æœ‰åˆå§‹åŒ–

```cpp
int& ref;  // âŒ é”™è¯¯ï¼šå¼•ç”¨å¿…é¡»åˆå§‹åŒ–
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
> å¼•ç”¨å¿…é¡»ç»‘å®šåˆ°æŸä¸ªå˜é‡ï¼Œä¸èƒ½æ‚¬ç©ºã€‚

**æ­£ç¡®å†™æ³•ï¼š**
```cpp
int x = 10;
int& ref = x;  // âœ… æ­£ç¡®
```

### 8.4 é”™è¯¯4ï¼šè¯•å›¾æ”¹å˜å¼•ç”¨çš„ç»‘å®š

```cpp
int x = 10;
int y = 20;
int& ref = x;  // ref ç»‘å®šåˆ° x

ref = y;  // è¿™ä¸æ˜¯è®© ref ç»‘å®šåˆ° yï¼Œè€Œæ˜¯æŠŠ y çš„å€¼èµ‹ç»™ x
```

**ä¸ºä»€ä¹ˆï¼Ÿ**
> å¼•ç”¨ä¸€æ—¦ç»‘å®šï¼Œå°±ä¸èƒ½æ”¹å˜ã€‚`ref = y` æ˜¯èµ‹å€¼æ“ä½œï¼Œä¸æ˜¯é‡æ–°ç»‘å®šã€‚

### 8.5 é”™è¯¯5ï¼šconst å¼•ç”¨ç»‘å®šåˆ°éœ€è¦ä¿®æ”¹çš„å˜é‡

```cpp
void increment(const int& x) {
    x++;  // âŒ é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹ const å¼•ç”¨
}
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
> `const` å¼•ç”¨æ˜¯åªè¯»çš„ï¼Œä¸èƒ½é€šè¿‡å®ƒä¿®æ”¹åŸå§‹å˜é‡ã€‚

**æ­£ç¡®å†™æ³•ï¼š**
```cpp
void increment(int& x) {  // å»æ‰ const
    x++;  // âœ… æ­£ç¡®
}
```

### 8.6 é”™è¯¯6ï¼šéconstå¼•ç”¨ç»‘å®šåˆ°ä¸´æ—¶å€¼

```cpp
std::string getString() {
    return "Hello";  // è¿”å›ä¸´æ—¶çš„ std::string å¯¹è±¡
}

int main() {
    std::string& ref = getString();  // âŒ é”™è¯¯ï¼šéconstå¼•ç”¨ä¸èƒ½ç»‘å®šåˆ°ä¸´æ—¶å¯¹è±¡
    std::cout << ref << std::endl;
    
    return 0;
}
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
> éconstå¼•ç”¨ä¸èƒ½ç»‘å®šåˆ°ä¸´æ—¶å¯¹è±¡ï¼Œå› ä¸ºä¸´æ—¶å¯¹è±¡æ˜¯å³å€¼ï¼Œæ™®é€šå¼•ç”¨åªèƒ½ç»‘å®šåˆ°å·¦å€¼ã€‚

**æ­£ç¡®å†™æ³•1ï¼šä½¿ç”¨constå¼•ç”¨ï¼ˆå®‰å…¨ï¼‰**
```cpp
int main() {
    const std::string& ref = getString();  // âœ… æ­£ç¡®ï¼šconstå¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å¯¹è±¡
    std::cout << ref << std::endl;  // å®‰å…¨ï¼ä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸè¢«å»¶é•¿
    
    return 0;
}
```

**C++æ ‡å‡†ä¿è¯ï¼š**
> constå¼•ç”¨ä¼šå»¶é•¿ä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåˆ°å¼•ç”¨æœ¬èº«çš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚æ‰€ä»¥ä¸Šé¢çš„ä»£ç æ˜¯å®Œå…¨å®‰å…¨çš„ã€‚

**æ­£ç¡®å†™æ³•2ï¼šç”¨å€¼æ¥å—ï¼ˆå¤åˆ¶ä¸´æ—¶å¯¹è±¡ï¼‰**
```cpp
int main() {
    std::string str = getString();  // å¤åˆ¶ä¸´æ—¶å¯¹è±¡åˆ°str
    std::cout << str << std::endl;  // å®‰å…¨
    
    return 0;
}
```

**éœ€è¦æ³¨æ„çš„å±é™©æƒ…å†µï¼š**
```cpp
const std::string& getDangerous() {
    std::string local = "Hello";
    return local;  // âŒ å±é™©ï¼šè¿”å›å±€éƒ¨å˜é‡çš„constå¼•ç”¨
}

int main() {
    const std::string& ref = getDangerous();  // refç»‘å®šåˆ°å·²é”€æ¯çš„å¯¹è±¡
    std::cout << ref << std::endl;  // æœªå®šä¹‰è¡Œä¸ºï¼
    return 0;
}
```
> è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯constå¼•ç”¨ä¹Ÿæ— æ³•å»¶é•¿å·²ç»è¢«é”€æ¯çš„å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸã€‚

---

## 9. æ€»ç»“å¯¹æ¯”è¡¨

### 9.1 å¼•ç”¨ vs å€¼ vs æŒ‡é’ˆ

| ç‰¹æ€§ | å€¼ï¼ˆValueï¼‰ | å¼•ç”¨ï¼ˆReferenceï¼‰ | æŒ‡é’ˆï¼ˆPointerï¼‰ |
|------|------------|------------------|----------------|
| è¯­æ³• | `int x` | `int& ref` | `int* ptr` |
| æ˜¯å¦å¤åˆ¶ | âœ… æ˜¯ | âŒ å¦ | âŒ å¦ |
| èƒ½å¦ä¸ºç©º | N/A | âŒ å¦ï¼ˆå¿…é¡»ç»‘å®šï¼‰ | âœ… æ˜¯ï¼ˆå¯ä»¥æ˜¯ nullptrï¼‰ |
| èƒ½å¦é‡æ–°ç»‘å®š | N/A | âŒ å¦ | âœ… æ˜¯ |
| è®¿é—®æ–¹å¼ | `x` | `ref` | `*ptr` |
| åœ°å€ | `&x` | `&ref`ï¼ˆå®é™…æ˜¯è¢«å¼•ç”¨å˜é‡çš„åœ°å€ï¼‰ | `ptr` |
| å®‰å…¨æ€§ | é«˜ | ä¸­ | ä½ï¼ˆå®¹æ˜“å‡ºé”™ï¼‰ |
| ä½¿ç”¨åœºæ™¯ | å°æ•°æ®ï¼Œä¸éœ€è¦ä¿®æ”¹ | å¤§æ•°æ®ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹ | éœ€è¦åŠ¨æ€å†…å­˜ã€å¯èƒ½ä¸ºç©º |

### 9.2 å‡½æ•°å‚æ•°çš„ä¼ é€’æ–¹å¼å¯¹æ¯”

| ä¼ é€’æ–¹å¼ | è¯­æ³• | å¤åˆ¶ | ä¿®æ”¹åŸå€¼ | é€Ÿåº¦ | å†…å­˜ | é€‚ç”¨åœºæ™¯ |
|---------|------|-----|---------|------|------|---------|
| ä¼ å€¼ | `void func(int x)` | âœ… | âŒ | æ…¢ | å¤š | å°æ•°æ®ï¼Œä¸éœ€è¦ä¿®æ”¹ |
| ä¼ å¼•ç”¨ | `void func(int& x)` | âŒ | âœ… | å¿« | å°‘ | å¤§æ•°æ®ï¼Œéœ€è¦ä¿®æ”¹ |
| ä¼ constå¼•ç”¨ | `void func(const int& x)` | âŒ | âŒ | å¿« | å°‘ | å¤§æ•°æ®ï¼Œä¸éœ€è¦ä¿®æ”¹ï¼ˆæœ€å¸¸ç”¨ï¼‰ |
| ä¼ æŒ‡é’ˆ | `void func(int* x)` | âŒ | âœ… | å¿« | å°‘ | å¯èƒ½ä¸ºç©ºï¼Œéœ€è¦ä¿®æ”¹ |
| ä¼ constæŒ‡é’ˆ | `void func(const int* x)` | âŒ | âŒ | å¿« | å°‘ | å¯èƒ½ä¸ºç©ºï¼Œä¸éœ€è¦ä¿®æ”¹ |

### 9.3 å‡½æ•°è¿”å›å€¼çš„æ–¹å¼å¯¹æ¯”

| è¿”å›æ–¹å¼ | è¯­æ³• | å¤åˆ¶ | é€‚ç”¨åœºæ™¯ | æ³¨æ„äº‹é¡¹ |
|---------|------|-----|---------|---------|
| è¿”å›å€¼ | `int func()` | âœ… | å±€éƒ¨å˜é‡ã€è®¡ç®—ç»“æœ | å®‰å…¨ï¼Œä½†æ…¢ |
| è¿”å›å¼•ç”¨ | `int& func()` | âŒ | å…¨å±€å˜é‡ã€å‚æ•°ã€æˆå‘˜å˜é‡ | ä¸èƒ½è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ |
| è¿”å›constå¼•ç”¨ | `const int& func()` | âŒ | åªè¯»çš„å…¨å±€å˜é‡ã€æˆå‘˜å˜é‡ | ä¸èƒ½è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ |
| è¿”å›æŒ‡é’ˆ | `int* func()` | âŒ | åŠ¨æ€åˆ†é…çš„å†…å­˜ | è°ƒç”¨è€…éœ€è¦ç®¡ç†å†…å­˜ |

### 9.4 æœ€ä½³å®è·µæ€»ç»“

#### å‡½æ•°å‚æ•°
```cpp
// 1. åŸºæœ¬ç±»å‹ï¼ˆint, double, charç­‰ï¼‰ï¼šä¼ å€¼
void process(int x);

// 2. å¤§å¯¹è±¡ï¼Œä¸ä¿®æ”¹ï¼šä¼  const å¼•ç”¨ï¼ˆæœ€å¸¸ç”¨ï¼‰
void process(const std::string& str);

// 3. å¤§å¯¹è±¡ï¼Œéœ€è¦ä¿®æ”¹ï¼šä¼ å¼•ç”¨
void modify(std::string& str);

// 4. å¯èƒ½ä¸ºç©ºï¼šä¼ æŒ‡é’ˆ
void process(int* ptr);
```

#### å‡½æ•°è¿”å›å€¼
```cpp
// 1. å±€éƒ¨å˜é‡ã€è®¡ç®—ç»“æœï¼šè¿”å›å€¼
int calculate();

// 2. æˆå‘˜å˜é‡ã€å…¨å±€å˜é‡ï¼ˆéœ€è¦ä¿®æ”¹ï¼‰ï¼šè¿”å›å¼•ç”¨
int& getData();

// 3. æˆå‘˜å˜é‡ã€å…¨å±€å˜é‡ï¼ˆåªè¯»ï¼‰ï¼šè¿”å› const å¼•ç”¨
const int& getData() const;

// 4. é“¾å¼è°ƒç”¨ï¼šè¿”å›è‡ªå·±çš„å¼•ç”¨
MyClass& chainable();
```

#### å¾ªç¯éå†
```cpp
std::vector<std::string> items = {"a", "b", "c"};

// 1. åŸºæœ¬ç±»å‹ï¼šä¼ å€¼
for (int num : numbers) { }

// 2. å¤§å¯¹è±¡ï¼Œåªè¯»ï¼šä¼  const å¼•ç”¨ï¼ˆæœ€å¸¸ç”¨ï¼‰
for (const std::string& item : items) { }

// 3. å¤§å¯¹è±¡ï¼Œéœ€è¦ä¿®æ”¹ï¼šä¼ å¼•ç”¨
for (std::string& item : items) { }
```

---

## 10. è¿›é˜¶ä¸»é¢˜ï¼ˆç®€ä»‹ï¼‰

### 10.1 å³å€¼å¼•ç”¨ï¼ˆRvalue Referenceï¼‰

C++11 å¼•å…¥äº†å³å€¼å¼•ç”¨ï¼Œç”¨ `&&` è¡¨ç¤ºã€‚

```cpp
int&& rref = 10;  // å³å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å€¼
```

**ç”¨é€”ï¼š**
- ç§»åŠ¨è¯­ä¹‰ï¼ˆMove Semanticsï¼‰
- å®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰

**æ³¨ï¼š** è¿™æ˜¯é«˜çº§ä¸»é¢˜ï¼Œåˆå­¦è€…æš‚æ—¶ä¸éœ€è¦æ·±å…¥ç†è§£ã€‚

### 10.2 å¼•ç”¨æŠ˜å ï¼ˆReference Collapsingï¼‰

å½“å¼•ç”¨çš„å¼•ç”¨å‡ºç°æ—¶ï¼Œä¼šå‘ç”Ÿå¼•ç”¨æŠ˜å ã€‚

```cpp
int x = 10;
int& r1 = x;
int& & r2 = r1;  // æŠ˜å ä¸º int&
```

**è§„åˆ™ï¼š**
- `& &` â†’ `&`
- `& &&` â†’ `&`
- `&& &` â†’ `&`
- `&& &&` â†’ `&&`

**æ³¨ï¼š** è¿™æ˜¯é«˜çº§ä¸»é¢˜ï¼Œåœ¨æ¨¡æ¿ç¼–ç¨‹ä¸­ä¼šç”¨åˆ°ã€‚

### 10.3 å®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰

ä½¿ç”¨ `std::forward` ä¿æŒå‚æ•°çš„å€¼ç±»åˆ«ï¼ˆå·¦å€¼æˆ–å³å€¼ï¼‰ã€‚

```cpp
template<typename T>
void wrapper(T&& arg) {
    func(std::forward<T>(arg));
}
```

**æ³¨ï¼š** è¿™æ˜¯é«˜çº§ä¸»é¢˜ï¼Œåœ¨ç¼–å†™æ³›å‹ä»£ç æ—¶ä¼šç”¨åˆ°ã€‚

---

## ç»“è¯­

å¼•ç”¨æ˜¯C++ä¸­éå¸¸é‡è¦çš„ç‰¹æ€§ï¼ŒæŒæ¡å¥½å¼•ç”¨å¯ä»¥è®©ä½ å†™å‡ºæ›´é«˜æ•ˆã€æ›´ä¼˜é›…çš„ä»£ç ã€‚

**æ ¸å¿ƒè¦ç‚¹ï¼š**
1. å¼•ç”¨æ˜¯åˆ«åï¼Œä¸æ˜¯ç‹¬ç«‹çš„å˜é‡
2. å¼•ç”¨å¿…é¡»åˆå§‹åŒ–ï¼Œä¸”ä¸èƒ½æ”¹å˜ç»‘å®š
3. å‡½æ•°å‚æ•°ä¼˜å…ˆä½¿ç”¨ `const å¼•ç”¨`ï¼ˆå¤§å¯¹è±¡ï¼‰
4. ä¸è¦è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨
5. å¼•ç”¨è®©ä»£ç æ›´å¿«ï¼ˆä¸å¤åˆ¶ï¼‰ã€æ›´å®‰å…¨ï¼ˆç±»å‹æ£€æŸ¥ï¼‰

**å­¦ä¹ å»ºè®®ï¼š**
- å¤šå†™ä»£ç ï¼Œå¤šç»ƒä¹ 
- é‡åˆ°é—®é¢˜ï¼Œæ€è€ƒæ˜¯å¦å¯ä»¥ç”¨å¼•ç”¨è§£å†³
- é˜…è¯»ä¼˜ç§€çš„å¼€æºä»£ç ï¼Œå­¦ä¹ ä»–ä»¬å¦‚ä½•ä½¿ç”¨å¼•ç”¨

ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼ğŸ‰

